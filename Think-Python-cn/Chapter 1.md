# 第一章
## 编程思想

本书期望能指导你做到像计算机专家一样思考。这意味着你要整合数学，工程和自然科学的知识去综合思考。比如数学，计算机专家用专业语言去表达观点(尤其关于计算)。比如工程师，他们设计原件，组装组件，构建系统，权衡各种方案。比如科学家，他们观察复杂系统行为，小心假设，积极求证。

计算机专家最重要的能力是解决问题。解决问题意味着可以分析问题，提出创造性解决方案，并能清晰准确表述。事实证明，学习编程是锻炼解决问题能力的极好机会。这也是本章叫做**编程思想**的缘由。

首先，我们学习如何编程，如何使用这个有用技能，再进一步，我们学习如何使用编程达到目标。随着我们不断前进，前景将越来越明朗。

### 1.1 Python语言

你将学习的编程语言叫*Python*. *Python*是一个类似于C, C++, Perl 和 Java的高级语言。

也有一些底层语言，例如机器语言或者汇编语言(以下统称机器语言)。宽泛来说，计算机只能运行机器语言。高级语言在运行前需要进行编译，而此编译过程比较耗时，这也是高级语言的一个劣势。

但是优点相对更多，首先，高级语言短小精悍，易于理解，更加适合人类编写，同时更不容易出错。再者，高级语言**易于迁移**，这意味着其不需修改或者仅仅稍微修改便可以在不同电脑上运行。机器语言只能在特定的一种机器上运行，如果想在其他机器运行，你需要重写。

```
源码 -> 解释器 -> 输出
```
**图1.1：** 解释器以中断方式切换执行读取和计算(每次执行一部分代码)。

```
源码 -> 编译器 -> 机器码 -> 执行器 -> 输出
```
**图1.2：**编译器将源码转成机器码，运行并输出。

基于以上优点，几乎所有的程序都会采用高级语言。一些特定应用才会采用机器语言。

高级语言转机器语言有两种方式：解释器和编译器。解释器直接读取并执行程序，所写即所得。即解释器会逐段读取并运行，流程见**图1.1**。

编译器需要先编译，后执行。此处，高级语言代码称为源码，编译后的程序，称为机器码或者执行码。只需编译一次，便可重复执行。编译流程见**图1.2**。

**Python**因为其被解释器解释执行，而被称为解释型语言。使用解释器有两种模式：交互模式和脚本模式。交互模式下，输入Python代码，解释器输出结果。

```python
>>> 1+1
2
```

箭头标识(>>>)意味着解释器准备好了，当你输入 `1+1`， 解释器输出 `2`。

另外，你可以将代码保存为文件，通过解释器去运行文件内容。此文件一般称作**脚本**。一般约定Python脚本文件均以 `.py` 为后缀。

执行脚本，需要告诉解释器脚本文件的名称。假如，想在一个UNIX的命令窗口中运行文件名为 `dinsdale.py`的脚本，一般输入 `python dinsdale.py`。不过不同开发环境下，脚本运行方式多有不同。关于Python运行环境的详细描述，可以参考 `https://python.org`。

交互模式因为可以即刻响应，所以便于测试一些小的代码片段。但如果代码量多，你最好保存为代码脚本，以便下次修改和执行。

### 1.2 什么是程序？
程序就是一系列如何运算的指令。运算可以是数学计算，例如解方程组，求多项式的根，也可以是内容处理，比如查找替换文档中的文字，(听起来有点奇怪)或者编译代码。

不同编程语言的细节多有不同，但是基本指令都类似：
- **输入**：从键盘，文件或其他设备中获取数据。
- **输出**： 将数据在屏幕展示，或者保存文件，发送给其他设备。
- **数学计算**：基本数学运算，例如加减乘除。
- **条件判断**：根据条件，选择执行。
- **循环**：重复执行，一般每次有些许变化。

不管你相信与否，就这么多指令。你曾经用过的每种编程语言，无论如何编译，基本都是这些指令构成的。所以你可以认为编码的过程，就是将一个个庞大复杂的模块，不断拆解成一个一个的足够小的功能，小到可以用上面的指令去运行。

虽然有点形而上，但是在**算法章节**我们会回头来思考这个问题。

### 1.3 什么是调试？

写代码是很容易出错的。由于历史原因，编码中的错误叫做异常(**bugs**)，而追踪异常的过程叫做调试(**debugging**).

程序异常一般包括： 语法错误，运行时异常，语义错误等。如此区分这些异常是为了能快速定位错误。

#### 1.3.1 语法错误
只有语法正确，Python程序才能运行。否则解释器会报错。语法泛指程序结构以及结构规定。例如小括号要成对出现，`(1+1)`合法，但是`8)`就是语法错误。

英文语境中，大部分语法错误不会影响你的理解，所以卡明斯的诗歌不会抛错。但是Python并不宽容，程序中任意一处语法错误，都会导致程序运行异常，并且抛错。一般你编程生涯的开始几周，大部分时间是追踪解决语法错误。随着经验增加，编码中的错误越来越少，定位也越来越快。

#### 1.3.2 运行时错误
第二种错误类型是运行时错误。也就是说只有程序开始运行后，才会报错。这些错误一般也称作**异常**，因为这些错误表示异常(或者坏的)问题发生了。

运行时异常在开始几章的简单代码里面很少见到，所以稍后章节才会涉及。

#### 1.3.3 语义错误
第三种类型是语义错误，如果程序存在语义错误，一般执行到结束也不会抛错，但是结果并不是我们想要的。也就是说得到的不是想要的。

问题在于你写的程序不是你想实现功能而应该写的。意味着程序(或语义)错误。通过监控程序的输出以及程序的执行过程，可以发现语义错误。

#### 1.3.4 如何调试
编码中最重要的一项技能就是调试。虽然调试过程比较枯燥，但是调试是编程中最需要才智，最具有挑战和趣味的部分。

某些时候，调试类似于侦探，你需要利用线索去分析导致此结果的各种流程和事件。

调试也像实验科学，一旦你猜测可能会出现问题，你就需要调整代码，并重新尝试。如果假设正确，你就能估计修改的结果，你也就离可执行程序更近了一些。如果假设不正确，你就要重新来过。就像*Sherlock Holmes*指出的，`排除一切不可能的，剩下的即使再不可能，那也是真相。`(柯南道尔的**符号四**)

对于某些人，编程和调试是同样的事情，因为编程就是逐步调试程序，直到程序正确运行。关键在于，从一段小程序开始，稍微修改，然后在编码过程中不断调试优化，这样你能保证程序时刻可用。

比如，Linux操作系统包含了成千上万行代码，但是它起始于*Linus Torvalds*研究Intel 80386芯片的一个小程序。据*Larry Greenfield* 描述，“Linus 早期仅仅开发了一段交替输出AAAA和BBBB的小程序，后来，这段小程序成长为了伟大的Linux项目。”(Linux用户指南第一版)。

后续篇幅会更深入讲解调试思路以及其他编程实践。

### 1.4 形式语言和自然语言

自然语言是平时人们说的语言，比如英语，西班牙语和法语。这类语言一般源于自然进化，不被某些人创造(虽然人们可以对其施加一些影响)。

形式语言是人们为特定领域或者用途设计的语言。例如，数学家使用的数学符号就是一种形式语言。这种语言非常适合表现数字和符号之间的关系。而化学家们使用另外一种形式语言来描述分子的化学结构。最重要的是：

`编程语言是表达计算的一种形式语言。`

形式语言往往有严格的语法要求。例如， `3+3=6`在数学领域是正确的语法，但是`3+=3$6`就不合乎语法。 `H2O` 在化学领域是语法正确的，但是`2Zz`就不正确。

语法一般由两部分构成，**标识(tokens)**和**结构(structure)**。标识是语言的基本元素，例如词汇，数字，以及化学元素，都是标识。`3+=3$6` 中的 `$`在数学中不是合法的标识(据我所知)。同样, `2Zz`在化学中也属非法，因为化学中没有这个元素`Zz`的缩写。

语法中另外一种规则，是语句结构合法。也就是说标识的顺序。比如数学中表达式 `3+=3`就不合法，即使 `+`和`=`都是合法标识，但是你不能将两个连起来一起用。同样的，化学表达式中，下标都在字母后面，而不能在前面。

**习题1.1.** 

> 用不合法字符，合法顺序写个英文语句。
然后用合法字符，不合法的顺序再写一个。

当你阅读一段英文语句或者某种形式语言的陈述时，你必须要明白句子结构(虽然你会不自觉地去处理自然语言)。这个过程就是**解析**。

例如，当你听到 "钱掉了"，你知道 "钱" 是主语，"掉" 是谓语。当你解析语句后，你就明白语句含义。假设你知道"钱"是什么，也知道"掉"代表什么，你就能明白这句话表示的含义。

虽然形式语言和自然语言有很多共同特征：标识，结构，语法，和语义。但是仍然有一些不同之处：

- **歧义：** 自然语言总是充满了歧义，人们需要用情景上下文和其他信息去猜测含义。形式语言基本不会存在歧义，无论如何应用，某句话就是唯一的意思。

- **冗余：** 为了避免歧义和减少误解，自然语言不得不画蛇添足很多语句来表示某个意思。这就显得很冗长。相对来说，形式语言就更加简练也更加明确。

- **字面：** 自然语言总是充斥着俗语和隐喻。如果我说， "(钱掉了)The Penny dropped",并不是说有钱或者什么东西掉了(一般这句话意味着某人恍然大悟)。而形式语言基本表里如一。

自然语言下长大的我们，如果想习惯形式语言，要经历一段时间刻苦训练。两者的不同就好比诗歌和散文:

- **诗歌：** 用大量的表意来营造整体从而引起情感共鸣。诗歌会大量使用表意词汇。

- **散文：** 用词浅显直白，行文结构也多有章法。散文相比于诗歌会清晰很多，但是也有部分表意词汇。


- **程序：** 电脑程序的标识和表述是不允许有歧义的，必须遵照相应规范，不可有一丝逾矩。

下面是一些阅读程代码(其他形式语言)的建议。首先，形式语言相比自然语言，更加细致繁琐，所以需要更多时间去阅读和理解。其次，结构很重要，所以不要总是从上往下，从左往右地阅读，而应该在大脑中去解析代码，区分标识和结构。最后，细节决定成败，单词错误，标点缺失，这些自然语言中无关紧要的小问题，在形式语言中往往很重要。

### 1.5 第一个程序

一般学习新语言时，你的第一个程序往往是打印显示出"Hello, World!"的"Hello, World!"程序。Python中，代码如下：

```python
print 'Hello, World!'
```
这是一个`print`语法例子，这并不会把任何东西打印到纸上，而是显示到屏幕上。在这里，运行结果：

```
Hello, World!
```
这里的引号是标识显示的内容的，并不会显示到屏幕上。

在Python3中，语法略有差异：

```python
print('Hello, World!')
```

括号表示`print`是个函数，关于函数的介绍在第三章。

### 1.6 调试

最好在读书过程中，用计算机学习案例。大部分例子可以在交互模式下运行，如果你采用脚本运行，更易于比较差异。

无论将来你如何实验，你都应该尽量去试错。例如，"Hello, world!"代码中，如果丢了一个引号会怎样? 如果两个引号都不写会如何? 如果`print`拼错了会怎样?

这么做会帮助你记忆理解你读到的代码，也会帮助你更好地调试，因为你知道错误信息是什么样子。最好的方案当然是当下有目的地试错，避免将来无辜犯错。

编码，尤其是调试，经常刺激你的情绪。如果你尝试解决一个严重问题，你经常会感到愤怒，沮丧和绝望。

有证据显示，人们往往将计算机当做人来对待，当程序一切正常，我们把他们当做伙伴，但是当编码中遇到顽固难题时，我们会把他们看作顽固无礼的人类。
(Reeves and Nass, The Media Equation: How People Treat Computers, Television, and New Media Like Real People and Places)

做好心理准备，将来才能更好解决问题。一种好的方法是你把计算机当做一个快速且精确的职员，但是他也有一些特别的缺点，缺乏对模糊概念的处理以及全局的兼顾。

你的任务就是做好协调：扬计算机之长避其之短。切勿因情绪而冲动，做情绪的主人，而非其奴隶。

调试往往令人沮丧，但是这恰恰是编程路上最有用的技能。每章最后都会有一个调试章节，这章同样，会附上我关于调试的一些思索。希望对大家有帮助！

### 1.7 术语表

- **解决问题**：分析问题，解决问题，并能清晰表达的过程。
- **高级语言**：像Python一样，便于人类读写的编程语言。 
- **底层语言**: 便于计算机执行的语言，也叫机器语言或者汇编语言。
- **便携性**: 程序可以在多个设备运行的特性。
- **解释性**: 执行高级语言编写的代码，一行一行解释执行。
- **编译性**：将高级语言编写的程序整体翻译为底层语言，以便后续执行。
- **源码**：编译前的高级语言代码。
- **目标码**：编译器编译程序后的输出码。
- **可执行**：可以执行的代码(同目标码)。
- **提示**：解释器显示字符，标识准备好接收用户的输入了。
- **脚本**：保存于文件的程序(通常是要解释器执行的)。
- **交互模式**：在提示窗口输入命令和表达式，从而使用Python解释器的方式。
- **脚本模式**：使用Python解释器读取执行脚本中程序的方式。
- **程序**：进行特定运算的一系列指令。
- **算法**：解决一类问题的通用方法。
- **漏洞**: 程序中的错误。
- **调试**: 发现并移除程序中的三种错误中的任意一种的方法。
- **语法**：程序代码结构。
- **语法错误**：代码中导致无法解析的错误(无法解释)。 
- **异常**： 程序运行中检测到的错误。
- **语义**：程序的逻辑。
- **语义错误**：程序的逻辑异常，导致程序未按预期执行。
- **自然语言**：人类自我进化发展而说的语言。
- **形式语言**：人类为特定目标而设计的语言，比如表达数学观点和计算机程序；所有的编程语言都是形式语言。
- **代码**：程序语法结构的基本元素，类似于自然语言中的单词。
- **解析**：检验程序并分析语法结构的过程。
- **print 语法**：令Python解释器显示语句的指令。

### 1.8 练习

**习题1.2.** 打开浏览器，进入Python网址 https://python.org. 这个网页包含Python相关信息，并且有Python相关页面的链接， 通过此可以搜索相关Python文档。

例如，如果你在搜索框输入`print`，显示的第一个链接就是`print`语法的文档。如此看来，这些并非都有用，但是你能知道去哪里查找。

**习题1.3.** 打开Python解释器，敲入 `help()`，进入在线帮助，或者你敲入`help('print')`，便可以获得关于`print`语法的信息。

如果操作失败，也许需要安装额外的*Python文档*，或者设置环境变量，具体细节请参考你的操作系统和Python版本。

**习题1.4.** 启动Python解释器，用来作为计算器。Python关于数学的语法和标准数学符号基本一样。例如， 符号`+,-` 和 `/` 分别表示，加法，减法和除法。表示乘法的符号是`*`。

如果你用43分30秒跑了个10千米竞赛， 你每英里需要多少时间？你每小时的平均速度是几英里？(提示： 1英里=1.61千米)
